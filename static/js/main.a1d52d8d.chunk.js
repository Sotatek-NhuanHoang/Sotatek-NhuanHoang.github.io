(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{138:function(e,t){},18:function(e,t){e.exports={user_AUTHENTICATED:"user_AUTHENTICATED",user_UNAUTHENTICATED:"user_UNAUTHENTICATED",room_ADD_NEW:"room_ADD_NEW",room_REMOVE:"room_REMOVE",room_UPDATE:"room_UPDATE",room_JOIN:"room_JOIN",room_EXIT:"room_EXIT",match_STROKE:"match_STROKE",match_READY_NEW_GAME:"match_READY_NEW_GAME",score_UPDATE:"score_UPDATE"}},21:function(e,t){e.exports={user_AUTHENTICATE:"user_AUTHENTICATE",user_LOGOUT:"user_LOGOUT",room_EXIT:"room_EXIT",match_STROKE:"match_STROKE",match_READY_NEW_GAME:"match_READY_NEW_GAME",match_WIN:"match_WIN"}},235:function(e,t,r){},236:function(e,t,r){},237:function(e,t,r){},238:function(e,t,r){},239:function(e,t,r){},240:function(e,t,r){},241:function(e,t,r){},247:function(e,t,r){},249:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(34),c=r.n(a),s=r(3),i=r(4),u=r(6),m=r(5),l=r(7),p=r(9),d=r(86),f=r(22),h=r(87),E=r(60),b=r(88),O=r.n(b),g=r(11),A=r(8),v=r.n(A),U=r(17),R=r(254),j=r(251),I=r(25),k=r(23),_=r(2),T=r.n(_),w=r(98),y=r(58),S=r.n(y),C=r(89),N=r.n(C),x={X:"X",O:"O"},D={API_SERVER_URL:"https://caro-api.herokuapp.com",API_SERVER_VERSION:"v1",SOCKET_SERVER_URL:"https://caro-socket.herokuapp.com",CARO_BOARD_ROW:30,CARO_BOARD_COLUMN:48,FIRST_MOVE_SQUARE_TYPE:x.X,SECOND_MOVE_SQUARE_TYPE:x.O},L=r(21),M=r.n(L),P=r(90),B=r(18),G=r.n(B),W=function(e,t){switch(e){case G.a.user_AUTHENTICATED:We(Ce({isSocketAuthenticated:!0,isSocketAuthenticating:!1}));break;case G.a.user_UNAUTHENTICATED:We(Ce({isSocketAuthenticated:!1,isSocketAuthenticating:!1}))}},Y=r(12),q=r(91),H=Object(q.create)({baseURL:D.API_SERVER_URL+"/"+D.API_SERVER_VERSION,headers:{Accept:"application/json","Content-Type":"application/json"}}),J={GET:function(){var e=Object(U.a)(v.a.mark(function e(t){var r,n,o,a,c,s=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=qe.getState(),o=n.user,a=T.a.get(o,["currentUser","token"]),e.prev=3,e.next=6,H.get(t,r,{headers:{Authorization:"Bearer "+a}});case 6:if((c=e.sent).ok){e.next=9;break}throw new Error(c.data.message);case 9:return e.abrupt("return",c.data);case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:case"end":return e.stop()}},e,null,[[3,12]])}));return function(t){return e.apply(this,arguments)}}(),POST:function(){var e=Object(U.a)(v.a.mark(function e(t){var r,n,o,a,c,s=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=qe.getState(),o=n.user,a=T.a.get(o,["currentUser","token"]),e.prev=3,e.next=6,H.post(t,r,{headers:{Authorization:"Bearer "+a}});case 6:if((c=e.sent).ok){e.next=9;break}throw new Error(c.data.message);case 9:return e.abrupt("return",c.data);case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:case"end":return e.stop()}},e,null,[[3,12]])}));return function(t){return e.apply(this,arguments)}}(),PUT:function(){var e=Object(U.a)(v.a.mark(function e(t){var r,n,o,a,c,s=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=qe.getState(),o=n.user,a=T.a.get(o,["currentUser","token"]),e.prev=3,e.next=6,H.put(t,r,{headers:{Authorization:"Bearer "+a}});case 6:if((c=e.sent).ok){e.next=9;break}throw new Error(c.data.message);case 9:return e.abrupt("return",c.data);case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:case"end":return e.stop()}},e,null,[[3,12]])}));return function(t){return e.apply(this,arguments)}}(),DELETE:function(){}},V={getRooms:function(e){return J.GET("/rooms/available",{page:e})},createRoom:function(){return J.POST("/rooms")},joinRoom:function(e){return J.PUT("/rooms/join",{roomId:e})}},F=r(59),K=r.n(F),Q=r(92),X={theme:"sunset",timeout:1e3,layout:"bottomCenter",progressBar:!1},z=function(e){new K.a(Object(g.a)({type:"alert",text:e},X)).show()},Z=function(e){new K.a(Object(g.a)({type:"info",text:e},X)).show()},$=r(42),ee={firstMoveUserId:null,winnerId:null,isCurentUserTurn:!1,squares:{},lastSquareIndex:"",winningSquares:{},currentUserReadyNewGame:!1,competitorUserReadyNewGame:!1},te=function(e,t,r,n,o,a){for(var c=Object(Y.a)({},e+","+t,!0),s=t-1;s>=0;s--){var i=e+","+s;if(r[i]!==n)break;c[i]=!0}for(var u=t+1;u<a;u++){var m=e+","+u;if(r[m]!==n)break;c[m]=!0}return T.a.keys(c).length>=5?c:null},re=function(e,t,r,n,o){for(var a=Object(Y.a)({},e+","+t,!0),c=e-1;c>=0;c--){var s=c+","+t;if(r[s]!==n)break;a[s]=!0}for(var i=e+1;i<o;i++){var u=i+","+t;if(r[u]!==n)break;a[u]=!0}return T.a.keys(a).length>=5?a:null},ne=function(e,t,r,n,o,a){for(var c=Object(Y.a)({},e+","+t,!0),s=e-1,i=t-1;s>=0&&i>=0;s--,i--){var u=s+","+i;if(r[u]!==n)break;c[u]=!0}for(var m=e+1,l=t+1;m<o&&l<a;m++,l++){var p=m+","+l;if(r[p]!==n)break;c[p]=!0}return T.a.keys(c).length>=5?c:null},oe=function(e,t,r,n,o,a){for(var c=Object(Y.a)({},e+","+t,!0),s=e-1,i=t+1;s>=0&&i<a;s--,i++){var u=s+","+i;if(r[u]!==n)break;c[u]=!0}for(var m=e+1,l=t-1;m<o&&l>=0;m++,l--){var p=m+","+l;if(r[p]!==n)break;c[p]=!0}return T.a.keys(c).length>=5?c:null},ae=function(e,t,r){for(var n=e[t+","+r],o=[te,re,ne,oe],a=0;a<o.length;a++){var c=o[a](t,r,e,n,D.CARO_BOARD_ROW,D.CARO_BOARD_COLUMN);if(c)return c}},ce=Object(R.a)("match_RESET"),se=Object(R.a)("match_UPDATE_STATE"),ie=Object(j.a)({match_RESET:function(e,t){var r=t.payload;return Object(g.a)({},T.a.cloneDeep(ee),r)},match_UPDATE_STATE:function(e,t){var r=t.payload;return Object(I.a)(e).mergeDeep(r).toJS()}},ee),ue=Object(k.a)(function(e,t,r){return{squares:e.squares,row:t,column:r}},function(e){return e.squares[e.row+","+e.column]}),me=Object(k.a)(function(e,t,r){return{winningSquares:e.winningSquares,row:t,column:r}},function(e){return e.winningSquares[e.row+","+e.column]||!1}),le=ie,pe=r(93),de=r.n(pe),fe=Object(R.a)("room_UPDATE_STATE"),he=(Object(R.a)("room_UPDATE_ONE"),Object(R.a)("room_REMOVE")),Ee=Object(j.a)({room_UPDATE_STATE:function(e,t){var r=t.payload;return Object(I.a)(e).mergeDeep(r).toJS()},room_REMOVE:function(e,t){var r=t.payload.roomId;return Object(I.a)(e).removeIn(["rooms",r]).toJS()}},{rooms:{},total:0,page:1,limit:20,isGettingRooms:!1,getRoomsError:null,joiningRoom:!1,joinRoomError:null,currentRoomId:null}),be=Object(k.a)(function(e,t){return{rooms:e.rooms,currentUser:t.currentUser}},function(e){var t=e.rooms,r=e.currentUser,n=T.a.filter(t,function(e){return e.status===de.a.WAITING&&e.creatorUserId!==r.id}),o=T.a.sortBy(n,function(e){return-e.updated});return T.a.map(o,function(e){return e.id})}),Oe=Object(k.a)(function(e,t){return{rooms:e.rooms,roomId:t}},function(e){return e.rooms[e.roomId]}),ge=Ee,Ae=function(e,t){switch(e){case G.a.room_ADD_NEW:We(Ce({otherUsers:Object(Y.a)({},t.creatorUser._id,Object(g.a)({id:t.creatorUser._id},t.creatorUser))})),We(fe({rooms:Object(Y.a)({},t.room._id,Object(g.a)({id:t.room._id},t.room))}));break;case G.a.room_REMOVE:var r=t.roomId;We(he({roomId:r}));break;case G.a.room_JOIN:We(Ce({otherUsers:Object(Y.a)({},t.competitorUser._id,Object(g.a)({id:t.competitorUser._id},t.competitorUser))})),We(fe({rooms:Object(Y.a)({},t.room._id,Object(g.a)({id:t.room._id},t.room))})),We(ce({firstMoveUserId:t.room.creatorUserId,isCurentUserTurn:!0}));break;case G.a.room_EXIT:var n=t.roomId,o=Ye(),a=o.user,c=o.room,s=a.currentUser;if(n!==c.currentRoomId)return;We(fe({rooms:Object(Y.a)({},n,{creatorUserId:s.id,competitorUserId:null})})),We(ce({firstMoveUserId:null}))}},ve=function(){var e=Object(U.a)(v.a.mark(function e(t,r){var n,o,a,c,s,i,u,m,l,p,d,f,h,E,b,O,g,A;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===G.a.match_STROKE?3:e.t0===G.a.match_READY_NEW_GAME?23:29;break;case 3:if(n=r.roomId,o=r.row,a=r.column,c=r.competitorUserId,s=Ye(),i=s.room,u=s.match,m=s.user,n===i.currentRoomId){e.next=7;break}return e.abrupt("return");case 7:if(l=m.currentUser,p=u.firstMoveUserId,d=o+","+a,f=l.id===p?D.SECOND_MOVE_SQUARE_TYPE:D.FIRST_MOVE_SQUARE_TYPE,We(se({squares:Object(Y.a)({},d,f),lastSquareIndex:d})),h=Ye(),E=h.match,!(b=ae(E.squares,o,a))){e.next=21;break}return We(se({winningSquares:b})),e.next=18,Object($.a)(1500);case 18:We(se({winnerId:c})),e.next=22;break;case 21:We(se({isCurentUserTurn:!0}));case 22:return e.abrupt("break",30);case 23:if(O=r.roomId,g=Ye(),A=g.room,O===A.currentRoomId){e.next=27;break}return e.abrupt("return");case 27:return We(se({competitorUserReadyNewGame:!0})),e.abrupt("break",30);case 29:return e.abrupt("break",30);case 30:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),Ue=Object(R.a)("score_UPDATE_STATE"),Re=Object(j.a)({score_UPDATE_STATE:function(e,t){var r=t.payload;return Object(I.a)(e).mergeDeep(r).toJS()}},{scores:{}}),je=Object(k.a)(function(e,t,r){return{scores:e.scores,userId:t,competitorUserId:r}},function(e){return e.scores[e.userId+","+e.competitorUserId]||0}),Ie=Re,ke=function(e,t){switch(e){case G.a.score_UPDATE:var r=t.scores,n=T.a.reduce(r,function(e,t){var r=t.userId,n=t.competitorUserId,o=t.score;return e[r+","+n]=o,e},{});We(Ue({scores:Object(g.a)({},n)}))}},_e=S()(D.SOCKET_SERVER_URL);N()(S.a.Manager)(_e);var Te=Object(P.a)([W,Ae,ve,ke]);_e.on("connect",function(){var e=Ye().user,t=T.a.get(e,["currentUser","token"]);t&&_e.emit(M.a.user_AUTHENTICATE,{token:t}),_e.on("*",function(e){var t=e.data,r=Object(w.a)(t,2),n=r[0],o=r[1];Te(n,o)})});var we=_e,ye={login:function(e){var t=e.accessToken,r=e.facebookId;return J.POST("/users/facebook/login",{accessToken:t,facebookId:r})}},Se={otherUsers:{},currentUser:{},isSocketAuthenticated:!1,isSocketAuthenticating:!1,isLogging:!1,loginError:null},Ce=(Object(R.a)("user_RESET"),Object(R.a)("user_UPDATE_STATE")),Ne=Object(j.a)({user_RESET:function(e,t){var r=t.payload;return Object(g.a)({},T.a.cloneDeep(Se),r)},user_UPDATE_STATE:function(e,t){var r=t.payload;return Object(I.a)(e).mergeDeep(r).toJS()}},Se),xe=Object(k.a)(function(e,t){return{otherUsers:e.otherUsers,userId:t}},function(e){return e.otherUsers[e.userId]}),De=Ne,Le=Object(f.c)({global:De,room:ge,user:Object(E.a)({key:"user",storage:O.a,whitelist:["currentUser"]},De),match:le,score:Ie}),Me=[h.a],Pe=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):function(e){return e})(f.a.apply(void 0,Me)),Be=Object(f.d)(Le,Pe),Ge=Object(E.b)(Be),We=Be.dispatch,Ye=Be.getState,qe=Be,He=r(252),Je=r(253),Ve=r(43),Fe=function(){if(!document.getElementById("caro-spinner")){var e=document.createElement("div");e.id="caro-spinner",document.body.appendChild(e),c.a.render(o.a.createElement("div",{className:"caro-spinner-container"},o.a.createElement(Ve.PacmanLoader,{color:"#95a5a6",size:25})),document.getElementById("caro-spinner"))}},Ke=function(){document.getElementById("caro-spinner")&&document.getElementById("caro-spinner").remove()},Qe=(r(235),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.props.token&&this.props.history.push("/rooms")}},{key:"componentDidMount",value:function(){document.title="Caro online"}},{key:"componentDidUpdate",value:function(e){!e.isLogging&&this.props.isLogging&&Fe(),e.isLogging&&!this.props.isLogging&&Ke(),!e.loginError&&this.props.loginError&&z("Can not connect to server"),this.props.token&&this.props.history.push("/rooms")}},{key:"onLoginButtonPressed",value:function(){var e=this,t=window.FB;t.login(function(){t.getLoginStatus(function(t){if("connected"===t.status){var r=t.authResponse,n=r.accessToken,o=r.userID;e.props._login(n,o)}})})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"login-screen"},o.a.createElement("h1",{className:"title"},"Caro online"),o.a.createElement("h6",null,"The world leader strategy game"),o.a.createElement("button",{className:"loginBtn loginBtn--facebook",onClick:function(){return e.onLoginButtonPressed()}},"Login with Facebook"))}}]),t}(n.PureComponent)),Xe=Object(p.b)(function(e){var t=e.user;return{token:T.a.get(t,["currentUser","token"]),isLogging:t.isLogging,loginError:t.loginError}},function(e){return{_login:function(t,r){return e(function(e){var t=e.accessToken,r=e.facebookId;return function(){var e=Object(U.a)(v.a.mark(function e(n){var o;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n(Ce({isLogging:!0,loginError:null})),e.prev=1,e.next=4,ye.login({accessToken:t,facebookId:r});case 4:o=e.sent,n(Ce({isLogging:!1,isSocketAuthenticating:!0,currentUser:{id:o._id,facebookId:o.facebookId,username:o.username,avatar:o.avatar,token:o.token}})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n(Ce({isLogging:!1,loginError:e.t0.message}));case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}()}({accessToken:t,facebookId:r}))}}})(Qe),ze=r(44),Ze=r.n(ze),$e=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.user;return e?o.a.createElement("span",null,e.username):null}}]),t}(n.PureComponent),et=Object(p.b)(function(e,t){var r=e.user;return{user:xe(r,t.userId)}})($e),tt=function(e){function t(){var e,r;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).onRoomItemClicked=function(){var e=r.props.room;if(!e)return null;r.props._joinRoom(e.id)},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.room;return e?o.a.createElement("tr",{className:"room-item",onClick:this.onRoomItemClicked},o.a.createElement("td",null,o.a.createElement(et,{userId:e.creatorUserId})),o.a.createElement("td",{className:"text-right"},"1/2")):null}}]),t}(n.PureComponent),rt=Object(p.b)(function(e,t){var r=e.room;return{room:Oe(r,t.roomId)}},function(e){return{_joinRoom:function(t){return e(function(e){return function(){var t=Object(U.a)(v.a.mark(function t(r){var n,o,a;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r(fe({joiningRoom:!0,joinRoomError:null})),t.prev=1,t.next=4,V.joinRoom(e);case 4:n=t.sent,o=n.room,a=n.creatorUser,r(Ce({otherUsers:Object(Y.a)({},a._id,Object(g.a)({id:a._id},a))})),r(fe({rooms:Object(Y.a)({},o._id,Object(g.a)({id:o._id},o)),currentRoomId:o._id,joiningRoom:!1})),r(ce({firstMoveUserId:a._id})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),r(fe({joiningRoom:!1,joinRoomError:t.t0.message}));case 14:case"end":return t.stop()}},t,null,[[1,11]])}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(tt),nt=(r(236),function(e){function t(){var e,r;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).trackScrolling=function(){var e=document.getElementById("room-screen-container");r.isBottom(e)&&r.props._getRooms()},r.onNewRoomButtonClicked=function(){r.props._createRoom()},r.onLogoutButtonClicked=function(){r.props._logout(),r.props.history.push("/")},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.props.token||this.props.history.push("/")}},{key:"componentDidMount",value:function(){document.title="Room",document.addEventListener("scroll",this.trackScrolling),this.props.isSocketAuthenticated?this.props._getRooms(!0):this.props._socketAuthenticate()}},{key:"componentDidUpdate",value:function(e){if(!e.isSocketAuthenticated&&this.props.isSocketAuthenticated&&this.props._getRooms(!0),!e.isSocketAuthenticating&&this.props.isSocketAuthenticating&&Fe(),e.isSocketAuthenticating&&!this.props.isSocketAuthenticating&&(Ke(),this.props.isSocketAuthenticated||(this.props._logout(),this.props.history.push("/"))),!e.joiningRoom&&this.props.joiningRoom&&Fe(),e.joiningRoom&&!this.props.joiningRoom&&Ke(),!e.joinRoomError&&this.props.joinRoomError)switch(this.props.joinRoomError){case Ze.a.ROOM_FULL:z("Room full");break;case Ze.a.ROOM_DELETED:z("Room has been deleted");break;default:z("Something went wrong")}if(!e.currentRoomId&&this.props.currentRoomId&&this.props.history.push("/match"),!e.getRoomsError&&this.props.getRoomsError){if(this.props.getRoomsError===Ze.a.UNAUTHENTICATED)return this.props._logout(),void this.props.history.push("/");z("Can not connect to server")}}},{key:"componentWillUnmount",value:function(){document.removeEventListener("scroll",this.trackScrolling)}},{key:"isBottom",value:function(e){return e.getBoundingClientRect().bottom<=window.innerHeight}},{key:"render",value:function(){var e=this.props,t=e.roomIds,r=e.isGettingRooms;return o.a.createElement("div",{id:"room-screen"},o.a.createElement("div",{id:"room-screen-container",className:"container grid-sm"},o.a.createElement("div",{className:"room-status-container"},o.a.createElement("button",{className:"add-button",onClick:this.onNewRoomButtonClicked},"New room"),o.a.createElement("button",{className:"btn btn-link",onClick:this.onLogoutButtonClicked},"Logout")),o.a.createElement("table",{className:"table table-hover"},o.a.createElement("tbody",null,T.a.map(t,function(e){return o.a.createElement(rt,{key:e,roomId:e})}))),o.a.createElement("div",{className:"spinner"},o.a.createElement(Ve.BeatLoader,{size:8,color:"#95a5a6",loading:r}))))}}]),t}(n.PureComponent)),ot=Object(p.b)(function(e){var t=e.room,r=e.user;return{token:T.a.get(r,["currentUser","token"]),isSocketAuthenticated:r.isSocketAuthenticated,isSocketAuthenticating:r.isSocketAuthenticating,totalRooms:t.total,roomIds:be(t,r),isGettingRooms:t.isGettingRooms,getRoomsError:t.getRoomsError,joiningRoom:t.joiningRoom,joinRoomError:t.joinRoomError,currentRoomId:t.currentRoomId}},function(e){return{_getRooms:function(t){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){var t=Object(U.a)(v.a.mark(function t(r,n){var o,a,c,s,i,u,m,l,p;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n(),a=o.room,c=e?1:a.page+1,!a.isGettingRooms){t.next=4;break}return t.abrupt("return");case 4:if(e||!((c-1)*a.limit>a.total)){t.next=6;break}return t.abrupt("return");case 6:return r(fe({isGettingRooms:!0,getRoomsError:null})),t.prev=7,t.next=10,V.getRooms(c,a.limit);case 10:s=t.sent,i=s.rooms,u=s.total,m=s.creatorUsers,l=T.a.reduce(m,function(e,t){return e[t._id]=Object(g.a)({id:t._id},t),e},{}),r(Ce({otherUsers:Object(g.a)({},l)})),p=T.a.reduce(i,function(e,t){return e[t._id]=Object(g.a)({id:t._id},t),e},{}),r(fe({isGettingRooms:!1,rooms:p,total:u,page:c})),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(7),r(fe({isGettingRooms:!1,getRoomsError:t.t0.message}));case 21:case"end":return t.stop()}},t,null,[[7,18]])}));return function(e,r){return t.apply(this,arguments)}}()}(t))},_createRoom:function(){return e(function(){var e=Object(U.a)(v.a.mark(function e(t){var r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(fe({joiningRoom:!0,joinRoomError:null})),e.prev=1,e.next=4,V.createRoom();case 4:r=e.sent,t(fe({rooms:Object(Y.a)({},r._id,Object(g.a)({id:r._id},r)),currentRoomId:r._id,joiningRoom:!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t(fe({joiningRoom:!1,joinRoomError:e.t0.message}));case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}())},_socketAuthenticate:function(){return e(function(e,t){var r=t().user,n=T.a.get(r,["currentUser","token"]);e(Ce({isSocketAuthenticated:!1,isSocketAuthenticating:!0})),we.emit(M.a.user_AUTHENTICATE,{token:n})})},_logout:function(){return e(function(e){e(Ce({currentUser:{token:""},isSocketAuthenticated:!1})),we.emit(M.a.user_LOGOUT)})}}})(nt),at=r(94),ct=r.n(at),st=r(95),it=r.n(st),ut=r(96),mt=r.n(ut),lt=(r(237),function(e){function t(){var e,r;Object(s.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(r=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).stroke=function(){var e=r.props,t=e.row,n=e.column;r.props._stroke(t,n)},r.renderXO=function(){var e=r.props.squareType;return e?o.a.createElement(n.Fragment,null,e===x.O?o.a.createElement("img",{className:"caro-board-image",alt:"o",src:it.a}):o.a.createElement("img",{className:"caro-board-image",alt:"x",src:mt.a})):null},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isWinningSquare,r=e.isLastSquare;return o.a.createElement("div",{id:"caro-board-square",className:ct()({"square-winning":t,"square-last-index":r}),onClick:this.stroke},this.renderXO())}}]),t}(n.PureComponent)),pt=Object(p.b)(function(e,t){var r=e.match;return{squareType:ue(r,t.row,t.column),isWinningSquare:me(r,t.row,t.column),isLastSquare:r.lastSquareIndex===t.row+","+t.column}},function(e){return{_stroke:function(t,r){return e(function(e,t){return function(){var r=Object(U.a)(v.a.mark(function r(n,o){var a,c,s,i,u,m,l,p,d,f,h,E,b,O,g;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=o(),c=a.match,s=a.user,i=a.room,u=c.isCurentUserTurn,m=c.squares,l=c.firstMoveUserId){r.next=5;break}return z("Waiting user ..."),r.abrupt("return");case 5:if(u){r.next=8;break}return z("Not your turn!"),r.abrupt("return");case 8:if(!m[p=e+","+t]){r.next=11;break}return r.abrupt("return");case 11:if(d=s.currentUser,f=d.id===l?D.FIRST_MOVE_SQUARE_TYPE:D.SECOND_MOVE_SQUARE_TYPE,h=i.rooms[i.currentRoomId],E=h.creatorUserId===d.id?h.competitorUserId:h.creatorUserId,n(se({isCurentUserTurn:!1,squares:Object(Y.a)({},p,f),lastSquareIndex:p})),we.emit(M.a.match_STROKE,{roomId:h.id,row:e,column:t,competitorUserId:E,userId:d.id}),b=o(),O=b.match,!(g=ae(O.squares,e,t))){r.next=25;break}return n(se({winningSquares:g})),we.emit(M.a.match_WIN,{userId:d.id,competitorUserId:E}),r.next=24,Object($.a)(1500);case 24:n(se({winnerId:d.id}));case 25:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()}(t,r))}}})(lt),dt=(r(238),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{id:"caro-board"},T.a.map(new Array(D.CARO_BOARD_ROW),function(e,t){return o.a.createElement("div",{className:"caro-board-row",key:t},T.a.map(new Array(D.CARO_BOARD_COLUMN),function(e,r){return o.a.createElement(pt,{key:r,row:t,column:r})}))}))}}]),t}(n.PureComponent)),ft=Object(p.b)(function(){return{}},function(e){return{}})(dt),ht=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.score;return o.a.createElement("div",{className:"chip"},"Wins: ",e)}}]),t}(n.PureComponent),Et=Object(p.b)(function(e,t){var r=e.score;return{score:je(r,t.userId,t.competitorUserId)}},function(e){return{}})(ht),bt=(r(239),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){!e.competitorUser&&this.props.competitorUser&&Z("".concat(this.props.competitorUser.username," has joined the room")),e.competitorUser&&!this.props.competitorUser&&Z("".concat(e.competitorUser.username," has lefted the room"))}},{key:"render",value:function(){var e=this.props,t=e.competitorUser,r=e.userId,a=e.isCurentUserTurn;return o.a.createElement("div",{id:"current-user"},t?o.a.createElement(n.Fragment,null,o.a.createElement("img",{className:"user-avatar",alt:"avatar",src:t.avatar}),o.a.createElement("p",{className:"user-name text-bold"},t.username,a?null:o.a.createElement("i",{className:"fas fa-user-clock user-current-turn-icon"})),o.a.createElement(Et,{userId:t.id,competitorUserId:r}),o.a.createElement("div",{className:"tool-box"})):o.a.createElement("p",null,"Waiting user..."))}}]),t}(n.PureComponent)),Ot=Object(p.b)(function(e,t){var r=e.user,n=e.match;return{competitorUser:xe(r,t.competitorUserId),isCurentUserTurn:n.isCurentUserTurn}},function(e){return{}})(bt),gt=(r(240),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentUser,r=e.competitorUserId,n=e.isCurentUserTurn;return o.a.createElement("div",{id:"current-user"},o.a.createElement("img",{className:"user-avatar",alt:"avatar",src:t.avatar}),o.a.createElement("p",{className:"user-name text-bold"},t.username,n?o.a.createElement("i",{className:"fas fa-user-clock user-current-turn-icon"}):null),o.a.createElement(Et,{userId:t.id,competitorUserId:r}),o.a.createElement("div",{className:"tool-box"}))}}]),t}(n.PureComponent)),At=Object(p.b)(function(e){var t=e.user,r=e.match;return{currentUser:t.currentUser,isCurentUserTurn:r.isCurentUserTurn}},function(e){return{}})(gt),vt=(r(241),function(e){function t(){var e,r;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).onBackButtonPressed=function(){r.props._exitRoom()},r.onExitRoomButtonClicked=function(){r.props._exitRoom()},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.props.currentRoomId||this.props.history.push("/rooms")}},{key:"componentDidMount",value:function(){document.title="Playing",window.addEventListener("popstate",this.onBackButtonPressed)}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.history,n=t.winnerId,o=t.currentUser,a=t.currentUserReadyNewGame,c=t.competitorUserReadyNewGame,s=t.room,i=t._playNewGame,u=t._reMatch,m=t._exitRoom;if(!e.room||s){if(!e.winnerId&&n)!function(e){var t=e.title,r=e.message,n=e.confirmText,o=void 0===n?"Yes":n,a=e.onConfirm,c=e.cancelText,s=void 0===c?"No":c,i=e.onCancel;Object(Q.confirmAlert)({title:t,message:r,buttons:[{label:o,onClick:a},{label:s,onClick:i}]})}({title:n===o.id?"You win":"You lose",message:"Play new game?",cancelText:"Exit room",onConfirm:function(){i()},onCancel:function(){m()}});!e.currentUserReadyNewGame&&a&&Fe(),e.currentUserReadyNewGame&&!a&&Ke(),!a||!c||e.currentUserReadyNewGame&&e.competitorUserReadyNewGame||(u(),Z("Start new match"))}else r.push("/rooms")}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.onBackButtonPressed)}},{key:"render",value:function(){var e=this.props,t=e.room,r=e.currentUser;if(!t)return null;var n=t.creatorUserId===r.id?t.competitorUserId:t.creatorUserId;return o.a.createElement("div",{id:"match-screen"},o.a.createElement(ft,null),o.a.createElement("div",{className:"user-container"},o.a.createElement(Ot,{userId:r.id,competitorUserId:n}),o.a.createElement(At,{competitorUserId:n}),o.a.createElement("button",{className:"exit-button",onClick:this.onExitRoomButtonClicked},o.a.createElement("i",{className:"fas fa-sign-out-alt fa-lg text-dark"}))))}}]),t}(n.PureComponent)),Ut=Object(p.b)(function(e){var t=e.room,r=e.user,n=e.match;return{currentRoomId:t.currentRoomId,room:Oe(t,t.currentRoomId),currentUser:r.currentUser,winnerId:n.winnerId,currentUserReadyNewGame:n.currentUserReadyNewGame,competitorUserReadyNewGame:n.competitorUserReadyNewGame}},function(e){return{_playNewGame:function(){return e(function(e,t){var r=t(),n=r.user,o=r.room,a=r.match,c=n.currentUser;if(a.winnerId){var s=o.rooms[o.currentRoomId],i=s.creatorUserId===c.id?s.competitorUserId:s.creatorUserId;s.competitorUserId&&(e(se({currentUserReadyNewGame:!0})),we.emit(M.a.match_READY_NEW_GAME,{roomId:s.id,competitorUserId:i}))}})},_reMatch:function(){return e(function(e,t){var r=t(),n=r.match,o=r.user,a=r.room,c=o.currentUser,s=n.winnerId,i=a.rooms[a.currentRoomId],u=c.id!==s,m=i.creatorUserId===c.id?i.competitorUserId:i.creatorUserId;e(ce({isCurentUserTurn:u,firstMoveUserId:u?c.id:m}))})},_exitRoom:function(){return e(function(e,t){var r=t(),n=r.room,o=r.user,a=n.currentRoomId,c=o.currentUser;if(a){var s=n.rooms[a],i=s.creatorUserId===c.id?s.competitorUserId:s.creatorUserId;e(fe({currentRoomId:null})),e(ce()),we.emit(M.a.room_EXIT,{roomId:a,userId:c.id,competitorUserId:i})}})}}})(vt),Rt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement(He.a,null,o.a.createElement("div",{id:"router"},o.a.createElement(Je.a,{path:"/",exact:!0,component:Xe}),o.a.createElement(Je.a,{path:"/rooms",exact:!0,component:ot}),o.a.createElement(Je.a,{path:"/match",exact:!0,component:Ut})))}}]),t}(n.PureComponent),jt=(r(243),r(244),r(245),r(246),r(247),r(248),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement(p.a,{store:qe},o.a.createElement(d.a,{loading:null,persistor:Ge},o.a.createElement(Rt,null)))}}]),t}(n.Component));console.log("Version 1.1.3"),c.a.render(o.a.createElement(jt,null),document.getElementById("root"))},44:function(e,t){e.exports={UNAUTHENTICATED:"UNAUTHENTICATED",USER_NOT_FOUND:"USER_NOT_FOUND",ROOM_FULL:"ROOM_FULL",ROOM_DELETED:"ROOM_DELETED"}},90:function(e,t,r){"use strict";(function(e){t.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(r,n){for(var o=function(o){e(function(){t[o](r,n)})},a=0;a<t.length;a++)o(a)}}}).call(this,r(142).setImmediate)},93:function(e,t){e.exports={WAITING:"WAITING",PLAYING:"PLAYING"}},95:function(e,t,r){e.exports=r.p+"static/media/o.11a067f2.png"},96:function(e,t){e.exports="data:image/png;base64,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"},99:function(e,t,r){e.exports=r(249)}},[[99,1,2]]]);
//# sourceMappingURL=main.a1d52d8d.chunk.js.map